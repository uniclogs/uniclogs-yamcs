<?xml version="1.0" encoding="UTF-8"?>
<SpaceSystem name="OreSat" xmlns:xtce="http://www.omg.org/space/xtce" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.omg.org/spec/XTCE/20180204 https://www.omg.org/spec/XTCE/20180204/SpaceSystem.xsd">
    <Header validationStatus="Working" classification="NotClassified" version="2.0" date="2022-09-08">
        <AuthorSet>
            <Author>Portland State Aerospace Society (PSAS)</Author>
        </AuthorSet>
    </Header>
    <TelemetryMetaData>
        <ParameterTypeSet>
            <IntegerParameterType name="uint1" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="1"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint2" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="2"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint3" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="3"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint4" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="4"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint5" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="5"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint6" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="6"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint7" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="7"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint8" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="8"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint16" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="16"/>
            </IntegerParameterType>
            <IntegerParameterType name="uint32" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="32"/>
            </IntegerParameterType>
            <IntegerParameterType name="int8" signed="true">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="twosComplement" sizeInBits="8"/>
            </IntegerParameterType>
            <IntegerParameterType name="int16" signed="true">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="twosComplement" sizeInBits="16"/>
            </IntegerParameterType>
            <IntegerParameterType name="int32" signed="true">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="twosComplement" sizeInBits="32"/>
            </IntegerParameterType>
            <BooleanParameterType name="bool1">
                <UnitSet/>
                <IntegerDataEncoding sizeInBits="1" encoding="unsigned"/>
            </BooleanParameterType>
            <StringParameterType name="string8">
                <StringDataEncoding encoding="UTF-8">
                    <SizeInBits>
                        <Fixed>
                            <FixedValue>8</FixedValue>
                        </Fixed>
                    </SizeInBits>
                </StringDataEncoding>
            </StringParameterType>
            <StringParameterType name="string24">
                <StringDataEncoding encoding="UTF-8">
                    <SizeInBits>
                        <Fixed>
                            <FixedValue>24</FixedValue>
                        </Fixed>
                    </SizeInBits>
                </StringDataEncoding>
            </StringParameterType>
            <EnumeratedParameterType name="srcdest">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="Source"/>
                    <Enumeration value="1" label="Destination"/>
                </EnumerationList>
            </EnumeratedParameterType>
            <EnumeratedParameterType name="trunc">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="Header Not Truncated"/>
                    <Enumeration value="1" label="Header Truncated"/>
                </EnumerationList>
            </EnumeratedParameterType>
            <EnumeratedParameterType name="bypass">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="Sequence Controlled QoS"/>
                    <Enumeration value="1" label="Expedited QoS"/>
                </EnumerationList>
            </EnumeratedParameterType>
            <EnumeratedParameterType name="protoctrl">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="TFDF contains user data"/>
                    <Enumeration value="1" label="TFDF contains protocol information"/>
                </EnumerationList>
            </EnumeratedParameterType>
            <EnumeratedParameterType name="opctrl">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="Operational Control Field is present"/>
                    <Enumeration value="1" label="Operational Control Field is not present"/>
                </EnumerationList>
            </EnumeratedParameterType>
            <EnumeratedParameterType name="satid">
                <IntegerDataEncoding sizeInBits="8"/>
                <EnumerationList>
                    <Enumeration value="0" label="OreSat0"/>
                    <Enumeration value="1" label="OreSat0.5"/>
                    <Enumeration value="2" label="OreSat1"/>
                </EnumerationList>
            </EnumeratedParameterType>
        </ParameterTypeSet>
        <ParameterSet>
            <Parameter parameterTypeRef="uint4" name="Version_Number"/>
            <Parameter parameterTypeRef="uint16" name="Spacecraft_ID"/>
            <Parameter parameterTypeRef="srcdest" name="Source_or_Destination"/>
            <Parameter parameterTypeRef="uint6" name="Virtual_Channel_ID"/>
            <Parameter parameterTypeRef="uint4" name="Multiplexer_Access_Point_ID"/>
            <Parameter parameterTypeRef="trunc" name="EOF_Flag"/>
            <Parameter parameterTypeRef="uint16" name="Frame_Length"/>
            <Parameter parameterTypeRef="bypass" name="Bypass_Flag"/>
            <Parameter parameterTypeRef="protoctrl" name="Protocol_Control_Flag"/>
            <Parameter parameterTypeRef="uint2" name="Spare"/>
            <Parameter parameterTypeRef="opctrl" name="Operational_Control_Flag"/>
            <Parameter parameterTypeRef="uint3" name="VC_Frame_Count_Length"/>
            <Parameter parameterTypeRef="uint32" name="Seq_Num"/>
            <Parameter parameterTypeRef="uint3" name="TFDZ_Construction"/>
            <Parameter parameterTypeRef="uint5" name="USLP_Protocol_ID"/>
            <Parameter parameterTypeRef="string24" name="APRS_DataType_ID"/>
            <Parameter parameterTypeRef="satid" name="APRS_Satellite_ID"/>
            <Parameter parameterTypeRef="uint8" name="APRS_Revision"/>
            <Parameter parameterTypeRef="uint16" name="CRC16"/>
            <Parameter parameterTypeRef="uint8" name="TempCmd" />
        </ParameterSet>
        <ContainerSet>
            <SequenceContainer abstract="true" name="USLP_Packet">
                <EntryList>
                    <ParameterRefEntry parameterRef="Version_Number">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>0</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Spacecraft_ID">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>4</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Source_or_Destination">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>20</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Virtual_Channel_ID">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>21</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Multiplexer_Access_Point_ID">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>27</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="EOF_Flag">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>31</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Frame_Length">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>32</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Bypass_Flag">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>48</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Protocol_Control_Flag">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>49</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Spare">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>50</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Operational_Control_Flag">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>52</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="VC_Frame_Count_Length">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>53</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="Seq_Num">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>56</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="TFDZ_Construction">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>64</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                    <ParameterRefEntry parameterRef="USLP_Protocol_ID">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>67</FixedValue>
                        </LocationInContainerInBits>
                    </ParameterRefEntry>
                </EntryList>
            </SequenceContainer>
            <SequenceContainer name="EDL_Packet">
                <EntryList>
                    <ContainerRefEntry containerRef="USLP_Packet">
                        <LocationInContainerInBits referenceLocation="containerStart">
                            <FixedValue>0</FixedValue>
                        </LocationInContainerInBits>
                    </ContainerRefEntry>
                    <ParameterRefEntry parameterRef="TempCmd" />
                </EntryList>
            </SequenceContainer>
            <SequenceContainer name="Beacon_Packet">
                <EntryList>
                    <ContainerRefEntry containerRef="APRS_Packet" />
                    <ContainerRefEntry containerRef="./C3/Status" />
                    <ContainerRefEntry containerRef="./BatteryPack1/BatteryPack/Status" />
                    <ContainerRefEntry containerRef="./BatteryPack2/BatteryPack/Status" />
                    <ContainerRefEntry containerRef="./Solar/Status" />
                    <ContainerRefEntry containerRef="./StarTracker/Status" />
                    <ContainerRefEntry containerRef="./GPS/Status" />
                    <ContainerRefEntry containerRef="./DxWifi/Status" />
                    <ParameterRefEntry parameterRef="CRC16" />
                </EntryList>
            </SequenceContainer>
            <SequenceContainer name="APRS_Packet">
                <EntryList>
                    <ParameterRefEntry parameterRef="APRS_DataType_ID" />
                    <ParameterRefEntry parameterRef="APRS_Satellite_ID" />
                    <ParameterRefEntry parameterRef="APRS_Revision" />
                    
                </EntryList>
            </SequenceContainer>
        </ContainerSet>
    </TelemetryMetaData>
    <CommandMetaData>
        <ArgumentTypeSet>
            <IntegerArgumentType name="uint1" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="1"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint2" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="2"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint3" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="3"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint4" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="4"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint5" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="5"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint6" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="6"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint8" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="8"/>
            </IntegerArgumentType>
            <IntegerArgumentType name="uint16" signed="false">
                <UnitSet/>
                <IntegerDataEncoding byteOrder="mostSignificantByteFirst" encoding="unsigned" sizeInBits="16"/>
            </IntegerArgumentType>
            <StringArgumentType name="string16" shortDescription="US-ASCII 2 chars">
                <UnitSet/>
                <StringDataEncoding encoding="US-ASCII" bitOrder="mostSignificantBitFirst">
                    <SizeInBits>
                        <Fixed>
                            <FixedValue>16</FixedValue>
                        </Fixed>
                    </SizeInBits>
                </StringDataEncoding>
            </StringArgumentType>
            <StringArgumentType name="string24" shortDescription="US-ASCII 3 chars">
                <UnitSet/>
                <StringDataEncoding encoding="US-ASCII" bitOrder="mostSignificantBitFirst">
                    <SizeInBits>
                        <Fixed>
                            <FixedValue>16</FixedValue>
                        </Fixed>
                    </SizeInBits>
                </StringDataEncoding>
            </StringArgumentType>
        </ArgumentTypeSet>
        <MetaCommandSet>
            <MetaCommand abstract="true" name="EDL_Command">
                <LongDescription>Abstract Command for all EDL Commands</LongDescription>
                <ArgumentList>
                    <Argument argumentTypeRef="uint8" name="Command"/>
                </ArgumentList>
                <CommandContainer name="EDL_Command_Packet">
                    <EntryList>
                        <FixedValueEntry name="Version_Number" binaryValue="C" sizeInBits="4"/>
                        <FixedValueEntry name="Spacecraft_ID" binaryValue="4F53" sizeInBits="16"/>Algorithm
                        <FixedValueEntry name="Source_or_Destination" binaryValue="1" sizeInBits="1"/>
                        <FixedValueEntry name="Virtual_Channel_ID" binaryValue="0" sizeInBits="6"/>
                        <FixedValueEntry name="Multiplexer_Access_Point_ID" binaryValue="0" sizeInBits="4"/>
                        <FixedValueEntry name="EOF_Flag" binaryValue="0" sizeInBits="1"/>
                        <FixedValueEntry name="Frame_Length" binaryValue="0000" sizeInBits="16"/>
                        <FixedValueEntry name="Bypass_Flag" binaryValue="0" sizeInBits="1" />
                        <FixedValueEntry name="Protocol_Control_Flag" binaryValue="0" sizeInBits="1"/>
                        <FixedValueEntry name="Spare" binaryValue="00" sizeInBits="2"/>
                        <FixedValueEntry name="Operational_Control_Flag" binaryValue="0" sizeInBits="1"/>
                        <FixedValueEntry name="VC_Frame_Count_Length" binaryValue="0" sizeInBits="3"/>
                        <FixedValueEntry name="Seq_Num" binaryValue="00000000" sizeInBits="32"/>
                        <FixedValueEntry name="TFDZ_Construction" binaryValue="7" sizeInBits="3"/>
                        <FixedValueEntry name="USLP_Protocol_ID" binaryValue="5" sizeInBits="5"/>
                        <ArgumentRefEntry argumentRef="Command"/>
                    </EntryList>
                </CommandContainer>
                <VerifierSet>
                    <CompleteVerifier name="Response">
                        <BooleanExpression>
                        <Condition>
                            <ParameterInstanceRef parameterRef="/yamcs/cmdHist/edl-seqnum" />
                            <ComparisonOperator>==</ComparisonOperator>
                            <ParameterInstanceRef parameterRef="Seq_Num"/>
                        </Condition>
                        </BooleanExpression>
                        <CheckWindow timeToStopChecking="PT15S" timeWindowIsRelativeTo="commandRelease" />
                    </CompleteVerifier>
                </VerifierSet>
                <DefaultSignificance consequenceLevel="vital"/>
                </MetaCommand>
        </MetaCommandSet>

    </CommandMetaData>
</SpaceSystem>